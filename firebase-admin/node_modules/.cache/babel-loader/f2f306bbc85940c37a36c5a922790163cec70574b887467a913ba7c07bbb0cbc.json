{"ast":null,"code":"import _objectSpread from\"/Users/bhuvanaa/Documents/my-react-app/firebase-admin/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{createContext,useContext,useEffect,useState}from'react';import{signInWithEmailAndPassword,signOut,onAuthStateChanged,createUserWithEmailAndPassword}from'firebase/auth';import{doc,getDoc,setDoc}from'firebase/firestore';import{auth,db}from'../firebase';import{jsx as _jsx}from\"react/jsx-runtime\";const AuthContext=/*#__PURE__*/createContext();export const useAuth=()=>{return useContext(AuthContext);};export const AuthProvider=_ref=>{let{children}=_ref;const[currentUser,setCurrentUser]=useState(null);const[adminData,setAdminData]=useState(null);const[loading,setLoading]=useState(true);// Sign up function\nconst signup=async(email,password,adminData)=>{const userCredential=await createUserWithEmailAndPassword(auth,email,password);const user=userCredential.user;// Create admin document in Firestore\nawait setDoc(doc(db,'admins',user.uid),_objectSpread(_objectSpread({},adminData),{},{role:'admin',isActive:true,createdAt:new Date()}));return userCredential;};// Sign in function\nconst signin=(email,password)=>{return signInWithEmailAndPassword(auth,email,password);};// Sign out function\nconst logout=()=>{return signOut(auth);};// Check if user is admin\nconst isAdmin=async user=>{if(!user)return false;try{const adminDoc=await getDoc(doc(db,'admins',user.uid));return adminDoc.exists()&&adminDoc.data().isActive;}catch(error){console.error('Error checking admin status:',error);return false;}};// Get admin data\nconst getAdminData=async user=>{if(!user)return null;try{const adminDoc=await getDoc(doc(db,'admins',user.uid));if(adminDoc.exists()){return adminDoc.data();}return null;}catch(error){console.error('Error getting admin data:',error);return null;}};useEffect(()=>{const unsubscribe=onAuthStateChanged(auth,async user=>{if(user){const isUserAdmin=await isAdmin(user);if(isUserAdmin){const adminInfo=await getAdminData(user);setCurrentUser(user);setAdminData(adminInfo);}else{setCurrentUser(null);setAdminData(null);await logout();}}else{setCurrentUser(null);setAdminData(null);}setLoading(false);});return unsubscribe;},[]);const value={currentUser,adminData,signup,signin,logout,isAdmin};return/*#__PURE__*/_jsx(AuthContext.Provider,{value:value,children:!loading&&children});};","map":{"version":3,"names":["React","createContext","useContext","useEffect","useState","signInWithEmailAndPassword","signOut","onAuthStateChanged","createUserWithEmailAndPassword","doc","getDoc","setDoc","auth","db","jsx","_jsx","AuthContext","useAuth","AuthProvider","_ref","children","currentUser","setCurrentUser","adminData","setAdminData","loading","setLoading","signup","email","password","userCredential","user","uid","_objectSpread","role","isActive","createdAt","Date","signin","logout","isAdmin","adminDoc","exists","data","error","console","getAdminData","unsubscribe","isUserAdmin","adminInfo","value","Provider"],"sources":["/Users/bhuvanaa/Documents/my-react-app/firebase-admin/src/contexts/AuthContext.js"],"sourcesContent":["import React, { createContext, useContext, useEffect, useState } from 'react';\nimport { \n  signInWithEmailAndPassword, \n  signOut, \n  onAuthStateChanged,\n  createUserWithEmailAndPassword\n} from 'firebase/auth';\nimport { doc, getDoc, setDoc } from 'firebase/firestore';\nimport { auth, db } from '../firebase';\n\nconst AuthContext = createContext();\n\nexport const useAuth = () => {\n  return useContext(AuthContext);\n};\n\nexport const AuthProvider = ({ children }) => {\n  const [currentUser, setCurrentUser] = useState(null);\n  const [adminData, setAdminData] = useState(null);\n  const [loading, setLoading] = useState(true);\n\n  // Sign up function\n  const signup = async (email, password, adminData) => {\n    const userCredential = await createUserWithEmailAndPassword(auth, email, password);\n    const user = userCredential.user;\n    \n    // Create admin document in Firestore\n    await setDoc(doc(db, 'admins', user.uid), {\n      ...adminData,\n      role: 'admin',\n      isActive: true,\n      createdAt: new Date()\n    });\n    \n    return userCredential;\n  };\n\n  // Sign in function\n  const signin = (email, password) => {\n    return signInWithEmailAndPassword(auth, email, password);\n  };\n\n  // Sign out function\n  const logout = () => {\n    return signOut(auth);\n  };\n\n  // Check if user is admin\n  const isAdmin = async (user) => {\n    if (!user) return false;\n    \n    try {\n      const adminDoc = await getDoc(doc(db, 'admins', user.uid));\n      return adminDoc.exists() && adminDoc.data().isActive;\n    } catch (error) {\n      console.error('Error checking admin status:', error);\n      return false;\n    }\n  };\n\n  // Get admin data\n  const getAdminData = async (user) => {\n    if (!user) return null;\n    \n    try {\n      const adminDoc = await getDoc(doc(db, 'admins', user.uid));\n      if (adminDoc.exists()) {\n        return adminDoc.data();\n      }\n      return null;\n    } catch (error) {\n      console.error('Error getting admin data:', error);\n      return null;\n    }\n  };\n\n  useEffect(() => {\n    const unsubscribe = onAuthStateChanged(auth, async (user) => {\n      if (user) {\n        const isUserAdmin = await isAdmin(user);\n        if (isUserAdmin) {\n          const adminInfo = await getAdminData(user);\n          setCurrentUser(user);\n          setAdminData(adminInfo);\n        } else {\n          setCurrentUser(null);\n          setAdminData(null);\n          await logout();\n        }\n      } else {\n        setCurrentUser(null);\n        setAdminData(null);\n      }\n      setLoading(false);\n    });\n\n    return unsubscribe;\n  }, []);\n\n  const value = {\n    currentUser,\n    adminData,\n    signup,\n    signin,\n    logout,\n    isAdmin\n  };\n\n  return (\n    <AuthContext.Provider value={value}>\n      {!loading && children}\n    </AuthContext.Provider>\n  );\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}